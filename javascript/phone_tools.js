var QHPass=QHPass||{};QHPass.bindGetcode=function(e,t,n,r,i){r=r||"",i=i||2;var s={phoneEmptyMsg:"\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a",failMsg:"\u624b\u673a\u53f7\u7684\u683c\u5f0f\u4e0d\u6b63\u786e\uff0c\u8bf7\u68c0\u67e5",smsEmptyMsg:"\u6821\u9a8c\u7801\u4e0d\u80fd\u4e3a\u7a7a",smsNumber:"\u8bf7\u586b\u5199\u6b63\u786e\u6821\u9a8c\u7801",smsMsg:"\u6821\u9a8c\u7801\u7684\u683c\u5f0f\u4e0d\u6b63\u786e\uff0c\u8bf7\u68c0\u67e5",pwdEmptyMsg:"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"},o=!1;$(e).click(function(e){var u=null,a=this,f=120,l=/^(13|14|15|17|18)[0-9]{9}$/,c=r==""?$(a).closest("table").find(".phone").val():r;if(!c){QHPass.Error.show(n,s.phoneEmptyMsg);return}if(i==2&&!l.test(c)){QHPass.Error.show(n,s.failMsg);return}$("#safemobile_tips span.ico").removeClass("ico-10").addClass("ico-6"),QHPass.Error.hide(n);if(o)return;o=!0,QHPass.ajax({url:"/smsApi/sendsmscode",data:{account:encodeURIComponent(c),condition:t,acctype:i,r:Math.random()},success:function(e){if(e.errno=="0"){$(a).hide();var t=$(a).closest("table").find(".sms-loading");t.html("\u77ed\u4fe1\u5df2\u53d1\u9001\uff0c"+f+"\u79d2\u540e\u70b9\u6b64\u53ef\u91cd\u53d1").show();var r=f;u=setInterval(function(){r<1?(t.hide(),$(a).show(),r=f,o=!1,clearInterval(u)):(r-=1,t.html("\u77ed\u4fe1\u5df2\u53d1\u9001\uff0c"+r+"\u79d2\u540e\u70b9\u6b64\u53ef\u91cd\u53d1"))},1e3)}else o=!1,clearInterval(u),QHPass.Error.show(n,e.errmsg)}}),e.preventDefault()})},function(){function t(e,t,n){this.type=e||[],this.id=t||[],this.err_arr=[]}var e={phoneEmptyMsg:"\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a",failMsg:"\u624b\u673a\u53f7\u7684\u683c\u5f0f\u4e0d\u6b63\u786e\uff0c\u8bf7\u68c0\u67e5",smsEmptyMsg:"\u6821\u9a8c\u7801\u4e0d\u80fd\u4e3a\u7a7a",smsNumber:"\u8bf7\u586b\u5199\u6b63\u786e\u6821\u9a8c\u7801",smsMsg:"\u68c0\u9a8c\u7801\u7684\u683c\u5f0f\u4e0d\u6b63\u786e\uff0c\u8bf7\u68c0\u67e5",pwdEmptyMsg:"\u767b\u5f55\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a",pwdformatWrong:"\u767b\u5f55\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165",pwdLong:"\u5bc6\u7801\u6700\u957f\u4e3a20\u4f4d"};t.prototype={resetErr:function(){this.err_arr=[]},showCorrect:function(e){$("#"+e+"_tips").hide()},showError:function(e,t){this.err_arr.push({id:e,msg:t});var n=$("#"+e+"_tips span.ico").hasClass("ico-14");n&&$("#"+e+"_tips span.ico").removeClass("ico-14").addClass("ico-6"),$("#"+e+"_text").html(t),$("#"+e+"_tips").show()},byteLen:function(e){return e.replace(/[^\x00-\xff]/g,"--").length},checkPhone:function(t){var n=/^(13|14|15|17|18)\d{9}$/,r=$.trim($("#"+t).val());r?n.test(r)?this.showCorrect(t):this.showError(t,e.failMsg):this.showError(t,e.phoneEmptyMsg)},checkSmsCode:function(t){var n=$.trim($("#"+t).val()),r=/^\d{6}$/;n?r.test(n)?n&&this.byteLen(n)!==6?this.showError(t,e.smsMsg):this.showCorrect(t):this.showError(t,e.smsNumber):this.showError(t,e.smsEmptyMsg)},checkPwd:function(t){var n=$("#"+t).val();n?this.byteLen(n)<6?this.showError(t,e.pwdformatWrong):this.byteLen(n)>20?this.showError(t,e.pwdLong):this.showCorrect(t):this.showError(t,e.pwdEmptyMsg)},beforeSubmit:function(){this.resetErr();var e=this;return chktype=e.type,iptid=e.id,$.each(chktype,function(t,n){n=="phoneNumber"?e.checkPhone(iptid[t]):n=="smsCode"?e.checkSmsCode(iptid[t]):n=="pwd"&&e.checkPwd(iptid[t])}),e.err_arr.length},init:function(){this.resetErr();var e=this;chktype=e.type,iptid=e.id,$.each(chktype,function(t,n){$("#"+iptid[t]).blur(function(){n=="phoneNumber"?e.checkPhone(iptid[t]):n=="smsCode"?e.checkSmsCode(iptid[t]):n=="pwd"&&e.checkPwd(iptid[t])})})}},QHPass.valid=t}(),QHPass.Error={errorHandler:null,show:function(e,t){var n=this;clearTimeout(n.errorHandler),$("#"+e+"_text").html(t),$("#"+e+"_tips").show(),n.errorHandler=setTimeout(function(){$("#"+e+"_tips").hide()},3e5)},hide:function(e){var t=this;clearTimeout(t.errorHandler),$("#"+e+"_tips").hide()}},QHPass.get=function(e,t,n){$.get(e,t,function(e){n&&n(e)},"json")}