(function(e){function s(){var e=decodeURIComponent(location.href);n=o(e,"uname")||o(e,"uemail")||o(e,"account"),n&&$("#passAccount").val(n),$("#findPwdStepOne").show()}function o(e,t){e=e.replace(/^[^?=]*\?/ig,"").split("#")[0];var n={};return e.replace(/(^|&)([^&=]+)=([^&]*)/g,function(e,t,r,i){r=decodeURIComponent(r),i=decodeURIComponent(i),r in n?n[r]instanceof Array?n[r].push(i):n[r]=[n[r],i]:n[r]=/\[\]$/.test(r)?[i]:i}),t?n[t]:n}function u(e){$("#"+e+"_wm").attr("src",captchaUrl+"&_="+Math.random())}function a(e){$("#"+e+"_wm, #"+e+"_modify_wm").off().click(function(t){u(e),t=t||window.event,t&&t.preventDefault?t.preventDefault():window.e.returnValue=!1})}function f(e,t){QHPass.ajax({url:"/findpwd/getIndexVC",data:{account:encodeURIComponent(e),r:Math.random()},success:function(n){n.errno=="0"?(i=n.acctype,l(n.acctype,e,n.vc,t)):n.errno=="1040500"?QHPass.Error.show("passAccount",'\u5e10\u53f7\u72b6\u6001\u5f02\u5e38\uff0c\u8bf7<a href="/complaint" target="_blank">\u8054\u7cfb\u5ba2\u670d</a>'):QHPass.Error.show("passAccount",n.errmsg)}})}function l(e,n,i,s){QHPass.get("/findpwd/getUserSecInfo",{account:encodeURIComponent(n),acctype:e,captcha:s,vc:i},function(i){if(i.errno==78e3||i.errno==78001)return captchaUrl=i.errdetail.captchaUrl,QHPass.Error.show("passPhrase",decodeURIComponent(i.errmsg)),u("account"),!1;$("#findPwdStepOne").hide(),$("#findPwdStepTwo").show();if(i.secMobile.value==""&&i.secEmail.value==""&&i.loginEmail.value==""&&i.secQuestion.value=="")$.dialog({content:"\u60a8\u6ca1\u6709\u8bbe\u7f6e\u5bc6\u4fdd\u65b9\u5f0f\uff0c3\u79d2\u540e\u5373\u5230\u5e10\u53f7\u7533\u8bc9\u9875\u9762",time:3,callback:function(){location.href="/complaint"}}).show();else{t=i.secMobile.vc;if(i.secMobile.value=="")$("#byPhoneWays").hide();else if(i.secMobile.lessMax=="0")$("#byPhoneNone").show(),$("#byPhoneDefault").hide();else{$("#secMobile_s").html(i.secMobile.value);try{QHPass.bindGetcode(".btn-auth-code",1,"phoneNumber",n,e)}catch(s){}}i.loginEmail.value==""?$("#byLoginWays").hide():i.loginEmail.lessMax=="0"?($("#byLoginEmailNone").show(),$("#byLoginEmailDefault").hide()):($("#loginEmail_s").html(i.loginEmail.value),a("loginEmail")),i.secEmail.value==""?$("#bySecEmailWays").hide():i.secEmail.lessMax=="0"?($("#bySecEmailNone").show(),$("#bySecEmailDefault").hide()):($("#secEmail_s").html(i.secEmail.value),a("secEmail")),i.secMobile.lessMax=="0"&&i.secEmail.lessMax=="0"&&i.loginEmail.lessMax=="0"&&(i.secQuestion.value!=""&&i.secQuestion.lessMax=="1"?($("#bySecQuestionWays").show(),$("#secQuestion_issue").html(i.secQuestion.value),a("secQuestion")):i.secQuestion.value!=""&&i.secQuestion.lessMax=="0"&&($("#bySecQuestionNone").html("<div style='padding-left:20px'>"+r+"</div>").show(),$("#bySecQuestionStep1").hide())),e==2&&i.secMobile.lessMax=="1"?($("#byPhoneWays").addClass("cur"),$("#byPhone").show(),$(".phonestep").blur(function(){var e=$(this).attr("id");if(e=="newpwd")v("newpwd","newpwd");else if(e=="reNewpwd")m("newpwd","reNewpwd");else if(e=="smsverCode"){var t=/^\d{6}$/ig;t.test($("#smsverCode").val())||QHPass.Error.show("smsverCode","\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u6821\u9a8c\u7801\uff01")}})):i.secEmail.lessMax=="1"?($("#bySecEmailWays").addClass("cur"),$("#bySecEmail").show(),u("secEmail")):i.loginEmail.lessMax=="1"?($("#byLoginWays").addClass("cur"),$("#byLoginEmail").show(),u("loginEmail")):i.secQuestion.lessMax=="1"?($("#bySecQuestionWays").addClass("cur"),$("#bySecQuestion").show(),u("secQuestion")):i.secMobile.value?($("#byPhoneWays").addClass("cur"),$("#byPhone").show()):i.secEmail.value?($("#bySecEmailWays").addClass("cur"),$("#bySecEmail").show()):i.loginEmail.value?($("#byLoginWays").addClass("cur"),$("#byLoginEmail").show()):i.secQuestion.value&&($("#bySecQuestionWays").addClass("cur"),$("#bySecQuestion").show()),$("#findAllWays").show()}})}function c(){$.each(["findPwdStepTwo","byPhone","byPhoneNone","byLoginEmail","byLoginEmailNone","bySecEmail","bySecEmailNone","bySecQuestion","bySecQuestionNone"],function(e,t){$("#"+t).hide()}),$.each(["findPwdStepOne","byPhoneDefault","byLoginEmailDefault","bySecEmailDefault","bySecQuestionDefault"],function(e,t){$("#"+t).show()}),h(),setTimeout(function(){location.href=QHDomain.i360+"/findpwd/"},1)}function h(){$.each($("input[type=text],input[type=password]"),function(e,t){$(t).val("")}),$(".fd-text-tip span >span").html("")}function p(e){function a(e){e+="";var t=e.length,n=!0;step=e.charCodeAt(t-1)-e.charCodeAt(0)>0?1:-1;for(var r=0;r<t-1;r++)if(step!==e.charCodeAt(r+1)-e.charCodeAt(r))return n=!1,n;return n}e+="";var t=e.length,n=e.split(""),r=$.unique(n),i=r.length,s=["asdasd","asdfgh","asdfghjkl","Iloveyou","qwerty","Password","Passwd","Woaini","Wodemima","Woaiwojia","zxcvbn","tamade","nimade","123abc","0123456","0123456789","100200","102030","121212","111222","115415","123000","123123","123789","12301230","123321","123456","1234560","123465","1234567","12345678","123456789","1234567890","123123123","1314520","1314521","147258369","147852369","159357","168168","201314","211314","321321","456456","4655321","521521","5201314","520520","741852","741852963","7758258","7758521","654321","852963","987654","963852741","000000","111111","11111111","112233","666666","888888","abcdef","abcabc","abc123","a1b2c3","aaa111","123qwe","qweasd","admin","password","p@ssword","passwd","iloveyou","1qaz2wsx","qwertyuiop","qq123456","1q2w3e4r","123456abc","abc123456","qazwsxedc","1q2w3e4r5t"],o=0;if(t<6||t>20)o=-1;else if(i==1)o=0;else if(a(e))o=1;else if(s.join("#").indexOf(e)>-1)o=2;else{var u={d:0,c:0,o:0};$.each(r,function(e,t){/\d/.test(t)?u.d=1:/[a-zA-Z]/.test(t)?u.c=1:u.o=1}),o=u.d+u.c+u.o+(t>9?2:1),o=o==2?o+1:o}return o}function d(){function e(e){var e=e||window.event;return e.target||e.srcElement}function t(e){var t=e.hintEl;return t&&g(t)}function n(t){var n=e(t),r=n.__emptyHintEl;if(!n||n.tagName!="INPUT"&&n.tagName!="TEXTAREA")return;r&&(n.value?r.style.display="none":r.style.display="")}function r(t){var n=e(t),r=n.__emptyHintEl;if(!n||n.tagName!="INPUT"&&n.tagName!="TEXTAREA")return;r&&(r.style.display="none")}if("placeholder"in document.createElement("input"))return;document.addEventListener?(document.addEventListener("focus",r,!0),document.addEventListener("blur",n,!0)):(document.attachEvent("onfocusin",r),document.attachEvent("onfocusout",n));var i=[document.getElementsByTagName("input"),document.getElementsByTagName("textarea")],s=0,o=0,u,a,f;for(s=0;s<2;s++){a=i[s];for(o=0;o<a.length;o++){f=a[o],u=f.getAttribute("placeholder"),emptyHintEl=f.__emptyHintEl;if(u&&!emptyHintEl){emptyHintEl=document.createElement("span"),emptyHintEl.innerHTML=u,emptyHintEl.className="emptyhint",emptyHintEl.onclick=function(e){return function(){try{e.focus()}catch(t){}}}(f);if(f.value||f==document.activeElement)emptyHintEl.style.display="none";f.parentNode.insertBefore(emptyHintEl,f),f.__emptyHintEl=emptyHintEl}}}}function v(e,t){var n=$("#"+e).val(),r=p(n),i=/[\u4e00-\u9fa5]+/;return i.test(n)?(QHPass.Error.show(t,Tip.err_pass_chinese),!1):r<3?n?r==-1?(QHPass.Error.show(t,Tip.err_pass_len_illegal),!1):r==0?(QHPass.Error.show(t,Tip.err_pass_same_chars),!1):r==1?(QHPass.Error.show(t,Tip.err_pass_notlx_chars),!1):r==2?(QHPass.Error.show(t,Tip.err_pass_levelLow),!1):(QHPass.Error.show(t,Tip.err_pass_levelLow),!1):(QHPass.Error.show(t,Tip.err_pass_empty),!1):(QHPass.Error.hide(t),!0)}function m(e,t){var n=$("#"+e).val(),r=$("#"+t).val();r?n!==r&&QHPass.Error.show(t,Tip.err_pass_diff):QHPass.Error.show(t,Tip.err_pass_empty)}var t="",n="",r="<span style='color:#FF0000'>\u4f7f\u7528\u6b64\u65b9\u5f0f\u5c1d\u8bd5\u6b21\u6570\u8fc7\u591a\uff0c\u8bf7\u660e\u65e5\u518d\u8bd5\u6216\u4f7f\u7528\u5176\u4ed6\u65b9\u5f0f\uff01</span>",i="";$(".other-account").click(function(e){c(),e.preventDefault()}),$("#loginEmailfindPwd").click(function(e){var t=QHPass.trim($("#loginEmailverCode").val());QHPass.ajax({url:"/findpwd/doSendLoginEmail",beforeSend:function(){if(!t)return QHPass.Error.show("byLoginEmail","\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801"),!1},data:{account:encodeURIComponent(n),acctype:i,captchaAppId:"i360",captcha:t},success:function(e){if(e.errno=="0"){var t=e.mailHostUrl;$("#byLoginEmail").hide(),$("#byLoginEmail_result_text").html(e.email),t?$("#byLoginEmail_result_link").attr({href:t}).show():$("#byLoginEmail_result_link").hide(),$("#byLoginEmail_result").show()}else e.errdetail&&(captchaUrl=e.errdetail.captchaUrl||captchaUrl),QHPass.Error.show("byLoginEmail",e.errmsg),u("loginEmail")}}),e.preventDefault()}),$("#secEmailfindPwd").click(function(e){var t=QHPass.trim($("#secEmailverCode").val());QHPass.ajax({url:"/findpwd/doSendSecEmail",beforeSend:function(){if(!t)return QHPass.Error.show("bySecEmail","\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801"),!1},data:{account:encodeURIComponent(n),acctype:i,captchaAppId:"i360",captcha:t},success:function(e){if(e.errno=="0"){var t=e.mailHostUrl;$("#bySecEmail").hide(),$("#bySecEmail_result_text").html(e.email),t?$("#bySecEmail_result_link").attr({href:t}).show():$("#bySecEmail_result_link").hide(),$("#bySecEmail_result").show()}else e.errdetail&&(captchaUrl=e.errdetail.captchaUrl||captchaUrl),QHPass.Error.show("bySecEmail",e.errmsg),u("secEmail")}}),e.preventDefault()}),$("#resetPwd").click(function(r){var s=$("#smsverCode").val(),o=$("#newpwd").val(),u=$("#reNewpwd").val(),a=/^\d{6}$/ig;QHPass.ajax({url:"/findpwd/doSetNewPwdByMoile",beforeSend:function(){if(!a.test(s))return QHPass.Error.show("smsverCode","\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u6821\u9a8c\u7801\uff01"),!1;if(!v("newpwd","newpwd"))return!1;if(o!==u)return QHPass.Error.show("reNewpwd","\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5\uff01"),!1},data:{smscode:s,pwdmethod:1,newpwd:hex_md5(o),reNewpwd:hex_md5(u),account:encodeURIComponent(n),acctype:i,vc:t},success:function(t){t.errno=="0"?$.dialog({content:"\u4fee\u6539\u5bc6\u7801\u6210\u529f\uff0c3\u79d2\u540e\u5373\u56de\u5230\u767b\u5f55\u9875\u9762",time:3,callback:function(){location.href=e}}).show():$.dialog({content:decodeURIComponent(t.errmsg),time:2,msgType:"wrong"}).show()}}),r.preventDefault()}),$(".useraccount").keyup(function(e){e.keyCode==13&&$("#findpwdToTwo").click()}),$("phonestep").keyup(function(e){e.keyCode==13&&$("#resetPwd").click()}),$(".stepLoginemail").keyup(function(e){e.keyCode==13&&$("#loginEmailfindPwd").click()}),$(".stepSecemail").keyup(function(e){e.keyCode==13&&$("#secEmailfindPwd").click()}),$(".answerstep").keyup(function(e){e.keyCode==13&&$("#secQuestionfindPwd").click()}),$(".answerpwd").keyup(function(e){e.keyCode==13&&$("#resetSecQUestionPwd").click()}),$("#findAllWays").click(function(e){var t=e.srcElement||e.target,n=$(t).parent().attr("data-type");$.each($("#findAllWays").find("li"),function(e,t){$(t).removeClass("cur")}),$(t).parent().addClass("cur"),h();switch(n){case"0":$(".col-1").hide(),$("#byPhone").show();break;case"1":$(".col-1").hide(),$("#bySecEmail").show(),u("secEmail");break;case"2":$(".col-1").hide(),$("#byLoginEmail").show(),u("loginEmail");break;case"3":$(".col-1").hide(),$("#bySecQuestion").show(),u("secQuestion")}e.preventDefault()}),$("#secQuestionfindPwd").click(function(r){var s=QHPass.trim($("#secQuestionverCode").val()),o=$("#secnewpwd").val(),a=$("#secreNewpwd").val();QHPass.ajax({url:"/findpwd/doAnswerSecQuestion",beforeSend:function(){return QHPass.trim($("#secQuestion_ans").val())?o?v("secnewpwd","secnewpwd")?a?o!=a?(QHPass.Error.show("secreNewpwd","\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u4e00\u81f4\uff0c\u8bf7\u68c0\u67e5"),!1):s?(QHPass.Error.hide("secQuestion_ans"),QHPass.Error.hide("secQuestionverCode"),QHPass.Error.hide("secreNewpwd"),QHPass.Error.hide("secnewpwd"),!0):(QHPass.Error.show("secQuestionverCode","\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801"),!1):(QHPass.Error.show("secreNewpwd","\u786e\u8ba4\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"),!1):!1:(QHPass.Error.show("secnewpwd","\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a"),!1):(QHPass.Error.show("secQuestion_ans","\u8bf7\u8f93\u5165\u60a8\u7684\u7b54\u6848"),!1)},data:{account:encodeURIComponent(n),acctype:i,secAnswer:$("#secQuestion_ans").val(),captchaAppId:"i360",captcha:s,vc:t,newpwd:hex_md5(o),reNewpwd:hex_md5(a)},success:function(t){t.errno=="0"?$.dialog({content:"\u4fee\u6539\u5bc6\u7801\u6210\u529f\uff0c3\u79d2\u540e\u5373\u56de\u5230\u767b\u5f55\u9875\u9762",time:3,callback:function(){location.href=e}}).show():(t.errdetail&&(captchaUrl=t.errdetail.captchaUrl||captchaUrl),$.dialog({content:decodeURIComponent(t.errmsg),time:3,msgType:"wrong"}).show(),$("#secQuestionverCode").val(""),u("secQuestion"))}}),r.preventDefault()}),$("#findpwdToTwo").click(function(){var e=QHPass.trim($("#passPhrase").val());n=QHPass.trim($("#passAccount").val());if(!n)return QHPass.Error.show("passAccount","\u8bf7\u8f93\u5165\u60a8\u767b\u9646360\u7f51\u7ad9\u6240\u4f7f\u7528\u7684\u5e10\u53f7"),!1;$("#passAccount_tips").hide();if(!e)return QHPass.Error.show("passPhrase","\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801"),!1;$("#passPhrase_tips").hide(),f(n,e)}),s(),d(),a("account")})(destUrl)